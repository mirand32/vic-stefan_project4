<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">

		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">

		<!-- Webpage Title -->
		<title>Project 4</title>

		<!-- Google Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Cabin:400,700|Varela" rel="stylesheet">

		<!-- Font Awesome -->
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ"
		 crossorigin="anonymous">

		<!-- CSS Stylesheet -->
		<link rel="stylesheet" href="public/styles/style.css">
	</head>
	<body>
		<!-- HEADER -->
		<header>
			<nav class="headerNav">
				<div class="wrapper">
					<h3>Title of our App</h3>
					<ul class="headerList">
						<li><a href="#">About</a></li>
						<li><a href="#">Resources</a></li>
						<li><i class="fab fa-facebook-f"></i></li>
						<li><i class="fab fa-twitter"></i></li>
					</ul>
				</div>
			</nav>
			<div class="title wrapper">
				<h1>Title of our App</h1>
				<div class="iconContainer">
					<i class="fas fa-leaf"></i>
				</div>
			</div>
		</header>
		<!-- END OF HEADER -->


		<!-- MAIN -->
		<main>
			<!-- SECTION 1: INTRO  -->
			<section class="introSection wrapper">
				<h4>Intro-title</h4>

				<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quae itaque voluptatibus earum repellat pariatur id officia autem sapiente quia quidem quas amet, a modi quo vero blanditiis porro. Consequatur, enim!Nulla iure beatae ipsum non, nisi voluptatem accusantium omnis impedit totam laborum pariatur, qui porro! Rerum quidem deleniti animi tenetur! Omnis rem nemo, quidem consequuntur sit fuga sapiente perspiciatis eveniet?</p>
			</section>
			<!-- END OF SECTION 1: INTRO -->


			<!-- SECTION 2: SEARCH -->
			<section class="searchSection">

				<div class="formBackground">

				<h4 class="wrapper">Search By</h4>
				
					<!-- Search Form -->
					<form action="" class="wrapper">
						<!-- Form Part 1: Choose Countries -->
						<fieldset class="countries">
							<button class="countriesButton">Countries</button>

							<div class="country">
								<label for="vanuatu">Vanuatu
									<input type="checkbox" class="countryNames" value="vanuatu">
								</label>
							</div>

							<div class="country">
								<label for="tonga">Tonga
									<input type="checkbox" class="countryNames" value="tonga">
								</label>
							</div>

							<div class="country">
								<label for="philippines">Philippines
									<input type="checkbox" class="countryNames" value="philippines">
								</label>
							</div>

							<div class="country">
								<label for="guatemala">Guatemala
									<input type="checkbox" class="countryNames" value="guatemala">
								</label>
							</div>

							<div class="country">
								<label for="bangladesh">Bangladesh
									<input type="checkbox" class="countryNames" value="bangladesh">
								</label>
							</div>

							<div class="country">
								<label for="solomon islands">Vanuatu
									<input type="checkbox" class="countryNames" value="solomon islands">
								</label>
							</div>

							<div class="country">
								<label for="brunei">Brunei
									<input type="checkbox" class="countryNames" value="Brunei">
								</label>
							</div>

							<div class="country">
								<label for="costa rica">Costa Rica
									<input type="checkbox" class="countryNames" value="costa rica">
								</label>
							</div>

							<div class="country">
								<label for="cambodia">Cambodia
									<input type="checkbox" class="countryNames" value="cambodia">
								</label>
							</div>

							<div class="country">
								<label for="papa new guinea">Papa New Guinea
									<input type="checkbox" class="countryNames" value="papa new guinea">
								</label>
							</div>

							<div class="country">
								<label for="el salvador">El Salvador
									<input type="checkbox" class="countryNames" value="el salvador">
								</label>
							</div>

							<div class="country">
								<label for="timor-leste">Timor-Leste
									<input type="checkbox" class="countryNames" value="timor-leste">
								</label>
							</div>

							<div class="country">
								<label for="mauritius">Mauritius
									<input type="checkbox" class="countryNames" value="mauritius">
								</label>
							</div>

							<div class="country">
								<label for="nicaragua">Nicaragua
									<input type="checkbox" class="countryNames" value="nicaragua">
								</label>
							</div>

							<div class="country">
								<label for="vguinea-bissau">Guinea-Bissau
									<input type="checkbox" class="countryNames" value="Guinea-Bissau">
								</label>
							</div>

							<div class="country">
								<label for="fiji">Fiji
									<input type="checkbox" class="countryNames" value="fiji">
								</label>
							</div>

							<div class="country">
								<label for="japan">Japan
									<input type="checkbox" class="countryNames" value="japan">
								</label>
							</div>

							<div class="country">
								<label for="vietnam">Vietnam
									<input type="checkbox" class="countryNames" value="vietnam">
								</label>
							</div>

							<div class="country">
								<label for="gambia">Gambia
									<input type="checkbox" class="countryNames" value="gambia">
								</label>
							</div>

							<div class="country">
								<label for="jamaica">Jamaica
									<input type="checkbox" class="countryNames" value="jamaica">
								</label>
							</div>

							<div class="country">
								<label for="haiti">Haiti
									<input type="checkbox" class="countryNames" value="haiti">
								</label>
							</div>

							<div class="country">
								<label for="chile">Chile
									<input type="checkbox" class="countryNames" value="chile">
								</label>
							</div>

							<div class="country">
								<label for="benin">Benin
									<input type="checkbox" class="countryNames" value="benin">
								</label>
							</div>

							<div class="country">
								<label for="guyana">Guyana
									<input type="checkbox" class="countryNames" value="guyana">
								</label>
							</div>

							<div class="country">
								<label for="niger">Niger
									<input type="checkbox" class="countryNames" value="niger">
								</label>
							</div>

							<div class="country">
								<label for="madagascar">Madagascar
									<input type="checkbox" class="countryNames" value="madagascar">
								</label>
							</div>

							<div class="country">
								<label for="dominican republic">Dominican Republic
									<input type="checkbox" class="countryNames" value="dominican republic">
								</label>
							</div>

							<div class="country">
								<label for="cameroon">Cameroon
									<input type="checkbox" class="countryNames" value="cameroon">
								</label>
							</div>

							<div class="country">
								<label for="chad">Chad
									<input type="checkbox" class="countryNames" value="chad">
								</label>
							</div>

							<div class="country">
								<label for="honduras">Honduras
									<input type="checkbox" class="countryNames" value="honduras">
								</label>
							</div>

							<div class="country">
								<label for="cape verde">Cape Verde
									<input type="checkbox" class="countryNames" value="cape verde">
								</label>
							</div>

							<div class="country">
								<label for="senegal">Senegal
									<input type="checkbox" class="countryNames" value="senegal">
								</label>
							</div>

							<div class="country">
								<label for="togo">Togo
									<input type="checkbox" class="countryNames" value="togo">
								</label>
							</div>

							<div class="country">
								<label for="djbouti">Djbouti
									<input type="checkbox" class="countryNames" value="djbouti">
								</label>
							</div>

							<div class="country">
								<label for="burundi">Burundi
									<input type="checkbox" class="countryNames" value="burundi">
								</label>
							</div>

							<div class="country">
								<label for="indonesia">Indonesia
									<input type="checkbox" class="countryNames" value="indonesia">
								</label>
							</div>

							<div class="country">
								<label for="sierra leone">Sierra Leone
									<input type="checkbox" class="countryNames" value="sierra leone">
								</label>
							</div>
						</fieldset>
						<!-- End of Form Part 1: Choose Country -->

						<!-- Form Part 2: Choose Vulnerable Groups -->
						<fieldset class="vulnerableGroups">

							<button class="vulnerableGroupButton">Vulnerable Groups</button>

							<div class="vulnerableGroup">
								<label for="6870">Aged Persons
									<input type="checkbox" class="vulnerableGroupNames" value="6870">
								</label>
							</div>
							
							<div class="vulnerableGroup">
								<label for="6871" >Children
									<input type="checkbox" class="vulnerableGroupNames" value="6871">
								</label>
							</div>

							<div class="vulnerableGroup">
								<label for="6872">Internationally Displaced Persons (IDPs)
									<input type="checkbox" class="vulnerableGroupNames" value="6872">
								</label>
							</div>

							<div class="vulnerableGroup">
								<label for="6873">Persons with Disabilities
									<input type="checkbox" class="vulnerableGroupNames" value="6873">
								</label>
							</div>

							<div class="vulnerableGroup">
								<label for="6874">Refugees
									<input type="checkbox" class="vulnerableGroupNames" value="6874">
								</label>
							</div>

							<div class="vulnerableGroup">
								<label for="6875" id="6875">Women
									<input type="checkbox" class="vulnerableGroupNames" value="6875">
								</label>
							</div>
						</fieldset>
						<!-- End of Form Part 2: Choose Vulnerable Groups -->

						<!-- Submit Form Button -->
						<button class="submitSearch">Submit</button>
						
					</form>
					<!-- End of Search Form -->
				</div>
			</section>
			<!-- END OF SECTION 2: SEARCH -->

		</main>
		<!-- END OF MAIN -->

		<!-- FOOTER -->
		<footer>

		</footer>
		<!-- END OF FOOTER -->

		<script src='https://code.jquery.com/jquery-3.2.1.min.js' integrity='sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4='
		 crossorigin='anonymous'></script>
		<!-- <script src="public/scripts/main.js"></script> -->
		<script>
			// Save API URL
			const apiURL = 'https://api.reliefweb.int/v1/reports?appname=apidoc';
			// Relief App namespace
			const app = {};
			const searchGroupKey = [];
			const searchCountryKey = [];
			let resultsArray = [];
			// Method to initialize events 
			app.events = function () {
				$(".countryNames").on("click", function () {
					const countryNameInput = $(this).val();
					if ($(this).is(':checked')) {
						searchCountryKey.push(countryNameInput);
					} else {
						const removeCountryName = searchCountryKey.indexOf(countryNameInput);
						return searchCountryKey.splice(removeCountryName, 1);
					}
				});
				$('.vulnerableGroupNames').on('change', function () {
					const vulnerableGroupInput = $(this).val();
					if ($(this).is(':checked')) {
						searchGroupKey.push(vulnerableGroupInput);
					} else {
						const removeVulnerableGroup = searchGroupKey.indexOf(vulnerableGroupInput);
						return searchGroupKey.splice(removeVulnerableGroup, 1);
					};
				})
				$(".submitSearch").on("click", async function (e) {
					e.preventDefault();
					const countryData = await app.getDisasterInfoCountries(searchCountryKey);
					$.when(
						countryData[0]
					).then(function (country) {
						const resultsArray = (country.data);
						console.log(resultsArray);

					})
				})
			}
			// Method to GET disaster info by Country
			app.getDisasterInfoCountries = (...query) => {
				query = query.map((item) => {
					return $.ajax({
						url: apiURL,
						method: 'GET',
						dataType: 'json',
						data: {
							"filter": {
								operator: 'AND',
								conditions: [
									{
										"field": "country",
										"value": item,
									},
									{
										"field": 'vulnerable_groups.id',
										"value": searchGroupKey,
										"operator": "OR"
									}
								],
							},
							"language": {
								"id": 267,
								"name": "English",
								"code": "en"
							},
							"limit": 1000,
							"preset": "latest",
							"query": {
								"value": 'analysis latest'
							}
						}
					})
				})
				return $.when(query);
			}
			// Init function to initialize app 
			app.init = function () {
				$('form')[0].reset();
				app.events();
			}
			// DOC READY
			$(function () {
				// Call init function
				app.init();
				// delete
			})
		</script>
	</body>
	</html>
