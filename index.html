<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">

		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">

		<!-- Webpage Title -->
		<title>Project 4</title>

		<!-- Google Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Cabin:400,700|Varela" rel="stylesheet">

		<!-- Font Awesome -->
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ"
		 crossorigin="anonymous">

		<!-- CSS Stylesheet -->
		<link rel="stylesheet" href="public/styles/style.css">
	</head>
	<body>
		<!-- HEADER -->
		<header>
			<nav class="headerNav">
				<div class="wrapper">
					<h3>Title of our App</h3>
					<ul class="headerList">
						<li><a href="#">About</a></li>
						<li><a href="#">Resources</a></li>
						<li><i class="fab fa-facebook-f"></i></li>
						<li><i class="fab fa-twitter"></i></li>
					</ul>
				</div>
			</nav>
			<div class="title wrapper">
				<h1>Title of our App</h1>
				<div class="iconContainer">
					<i class="fas fa-leaf"></i>
				</div>
			</div>
		</header>
		<!-- END OF HEADER -->


		<!-- MAIN -->
		<main>
			<!-- SECTION 1: INTRO  -->
			<section class="introSection wrapper">
				<h4>Intro-title</h4>

				<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quae itaque voluptatibus earum repellat pariatur id officia autem sapiente quia quidem quas amet, a modi quo vero blanditiis porro. Consequatur, enim!Nulla iure beatae ipsum non, nisi voluptatem accusantium omnis impedit totam laborum pariatur, qui porro! Rerum quidem deleniti animi tenetur! Omnis rem nemo, quidem consequuntur sit fuga sapiente perspiciatis eveniet?</p>
			</section>
			<!-- END OF SECTION 1: INTRO -->


			<!-- SECTION 2: SEARCH -->
			<section class="searchSection">

				<div class="formBackground">

				<h4 class="wrapper">Search By</h4>
				
					<!-- Search Form -->
					<form action="" class="wrapper">
						<button class="countriesButton">Countries</button>
						<button class="vulnerableGroupButton">Vulnerable Groups</button>

						<!-- Form Part 1: Choose Countries -->
						<fieldset class="countries">
							
							<div class="countryTable">
								<div class="country">
									<p>Bangladesh</p>
									<label for="bangladesh">
										<input type="checkbox" id="bangladesh" class="countryNames" value="bangladesh">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Benin</p>
									<label for="benin">
										<input type="checkbox" id="benin" class="countryNames" value="benin">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Brunei</p>
									<label for="brunei">
										<input type="checkbox" id="brunei" class="countryNames" value="Brunei">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Burundi</p>
									<label for="burundi">
										<input type="checkbox" id="burundi" class="countryNames" value="burundi">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Cambodia</p>
									<label for="cambodia">
										<input type="checkbox" id="cambodia" class="countryNames" value="cambodia">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Cameroon</p>
									<label for="cameroon">
										<input type="checkbox" id="cameroon" class="countryNames" value="cameroon">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Cape Verde</p>
									<label for="capeVerde">
										<input type="checkbox" id="capeVerde" class="countryNames" value="cape verde">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Chad</p>
									<label for="chad">
										<input type="checkbox" id="chad" class="countryNames" value="chad">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Chile</p>
									<label for="chile">
										<input type="checkbox" id="chile" class="countryNames" value="chile">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Costa Rica</p>
									<label for="costaRica">
										<input type="checkbox" id="costaRica" class="countryNames" value="costa rica">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Djbouti</p>
									<label for="djbouti">
										<input type="checkbox" id="djbouti" class="countryNames" value="djbouti">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Dominican Republic</p>
									<label for="dominicanRepublic">
										<input type="checkbox" id="dominicanRepublic" class="countryNames" value="dominican republic">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>El Salvador</p>
									<label for="elSalvador">
										<input type="checkbox" id="elSalvador" class="countryNames" value="el salvador">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Fiji</p>
									<label for="fiji">
										<input type="checkbox" id="fiji" class="countryNames" value="fiji">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Gambia</p>
									<label for="gambia">
										<input type="checkbox" id="gambia "class="countryNames" value="gambia">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Guatemala</p>
									<label for="guatemala">
										<input type="checkbox" id="guatemala" class="countryNames" value="guatemala">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Guinea-Bissau</p>
									<label for="guineaBissau">
										<input type="checkbox" id="guineaBissau" class="countryNames" value="Guinea-Bissau">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Guyana</p>
									<label for="guyana">
										<input type="checkbox" id="guyana" class="countryNames" value="guyana">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Haiti</p>
									<label for="haiti">
										<input type="checkbox" id="haiti" class="countryNames" value="haiti">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Honduras</p>
									<label for="honduras">
										<input type="checkbox" id="honduras" class="countryNames" value="honduras">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Indonesia</p>
									<label for="indonesia">
										<input type="checkbox" id="indonesia" class="countryNames" value="indonesia">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Japan</p>
									<label for="japan">
										<input type="checkbox" id="japan" class="countryNames" value="japan">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Jamaica</p>
									<label for="jamaica">
										<input type="checkbox" id="jamaica" class="countryNames" value="jamaica">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Madagascar</p>
									<label for="madagascar">
										<input type="checkbox" id="madagascar" class="countryNames" value="madagascar">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Mauritius</p>
									<label for="mauritius">
										<input type="checkbox" id="mauritius" class="countryNames" value="mauritius">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Nicaragua</p>
									<label for="nicaragua">
										<input type="checkbox" id="nicaragua" class="countryNames" value="nicaragua">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Niger</p>
									<label for="niger">
										<input type="checkbox" id="niger" class="countryNames" value="niger">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Papa New Guinea</p>
									<label for="papaNewGuinea">
										<input type="checkbox" id="papaNewGuinea" class="countryNames" value="papa new guinea">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Philippines</p>
									<label for="philippines">
										<input type="checkbox" id="philippines" class="countryNames" value="philippines">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Senegal</p>
									<label for="senegal">
										<input type="checkbox" id="senegal" class="countryNames" value="senegal">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Sierra Leone</p>
									<label for="sierraLeone">
										<input type="checkbox" id="sierraLeone" class="countryNames" value="sierra leone">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Timor-Leste</p>
									<label for="timorLeste">
										<input type="checkbox" id="timorLeste" class="countryNames" value="timor-leste">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Tonga</p>
									<label for="tonga">
										<input type="checkbox" id="tonga" class="countryNames" value="tonga">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Togo</p>
									<label for="togo">
										<input type="checkbox" id="togo" class="countryNames" value="togo">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Vanuatu</p>
									<label for="vanuatu">
										<input type="checkbox" id="vanuatu" class="countryNames" value="vanuatu">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="country">
									<p>Vietnam</p>
									<label for="vietnam">
										<input type="checkbox" id="vietnam" class="countryNames" value="vietnam">
										<span class="checkmark"></span>
									</label>
								</div>
							</div>
						</fieldset>
						<!-- End of Form Part 1: Choose Country -->

						<!-- Form Part 2: Choose Vulnerable Groups -->
						<fieldset class="vulnerableGroups">

							<!-- <button class="vulnerableGroupButton">Vulnerable Groups</button> -->

							<div class="vulnerableGroupTable">
								<div class="vulnerableGroup">
									<p>Aged Persons</p>
									<label for="6870">
										<input type="checkbox" id="6870" class="vulnerableGroupNames" value="6870">
										<span class="checkmark"></span>
									</label>
								</div>
								
								<div class="vulnerableGroup">
									<p>Children</p>
									<label for="6871" >
										<input type="checkbox" id="6871" class="vulnerableGroupNames" value="6871">
										<span class="checkmark"></span>
									</label>
								</div>

								<div class="vulnerableGroup">
									<p>Internationally Displaced Persons</p>
									<label for="6872">
										<input type="checkbox" id="6872" class="vulnerableGroupNames" value="6872">
										<span class="checkmark"></span>
									</label>
								</div>

								<div class="vulnerableGroup">
									<p>Persons with Disabilities</p>
									<label for="6873">
										<input type="checkbox" id="6873" class="vulnerableGroupNames" value="6873">
										<span class="checkmark"></span>
									</label>
								</div>

								<div class="vulnerableGroup">
									<p>Refugees</p>
									<label for="6874">
										<input type="checkbox" id="6874" class="vulnerableGroupNames" value="6874">
										<span class="checkmark"></span>
									</label>
								</div>

								<div class="vulnerableGroup">
									<p>Women</p>
									<label for="6875">
										<input type="checkbox" id="6875" class="vulnerableGroupNames" value="6875">
										<span class="checkmark"></span>
									</label>
								</div>
							</div>
						</fieldset>
						<!-- End of Form Part 2: Choose Vulnerable Groups -->

						<!-- Submit Form Button -->
						<button class="submitSearch">Submit</button>
						
					</form>
					<!-- End of Search Form -->
				</div>
			</section>
			<!-- END OF SECTION 2: SEARCH -->

		</main>
		<!-- END OF MAIN -->

		<!-- FOOTER -->
		<footer>

		</footer>
		<!-- END OF FOOTER -->

		<script src='https://code.jquery.com/jquery-3.2.1.min.js' integrity='sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4='
		 crossorigin='anonymous'></script>
		<!-- <script src="public/scripts/main.js"></script> -->
		<script>
			// Save API URL
			const apiURL = 'https://api.reliefweb.int/v1/reports?appname=apidoc';
			// Relief App namespace
			const app = {};
			const searchGroupKey = [];
			const searchCountryKey = [];
			let resultsArray = [];
			// Method to initialize events 
			app.events = function () {
				$(".countryNames").on("click", function () {
					const countryNameInput = $(this).val();
					if ($(this).is(':checked')) {
						searchCountryKey.push(countryNameInput);
					} else {
						const removeCountryName = searchCountryKey.indexOf(countryNameInput);
						return searchCountryKey.splice(removeCountryName, 1);
					}
				});
				$('.vulnerableGroupNames').on('change', function () {
					const vulnerableGroupInput = $(this).val();
					if ($(this).is(':checked')) {
						searchGroupKey.push(vulnerableGroupInput);
					} else {
						const removeVulnerableGroup = searchGroupKey.indexOf(vulnerableGroupInput);
						return searchGroupKey.splice(removeVulnerableGroup, 1);
					};
				})
				$(".submitSearch").on("click", async function (e) {
					e.preventDefault();
					const countryData = await app.getDisasterInfoCountries(searchCountryKey);
					$.when(
						countryData[0]
					).then(function (country) {
						const resultsArray = (country.data);
						console.log(resultsArray);

					})
				})
			}
			// Method to GET disaster info by Country
			app.getDisasterInfoCountries = (...query) => {
				query = query.map((item) => {
					return $.ajax({
						url: apiURL,
						method: 'GET',
						dataType: 'json',
						data: {
							"filter": {
								operator: 'AND',
								conditions: [
									{
										"field": "country",
										"value": item,
									},
									{
										"field": 'vulnerable_groups.id',
										"value": searchGroupKey,
										"operator": "OR"
									}
								],
							},
							"language": {
								"id": 267,
								"name": "English",
								"code": "en"
							},
							"limit": 1000,
							"preset": "latest",
							"query": {
								"value": 'analysis latest'
							}
						}
					})
				})
				return $.when(query);
			}
			// Init function to initialize app 
			app.init = function () {
				$('form')[0].reset();
				app.events();
			}
			// DOC READY
			$(function () {
				// Call init function
				app.init();
				// delete
			})
		</script>
	</body>
	</html>
